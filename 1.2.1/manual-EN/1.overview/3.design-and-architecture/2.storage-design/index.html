
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Documentation for Nebula Graph Database" name="description"/>
<link href="https://docs.nebula-graph.io/manual-EN/1.overview/3.design-and-architecture/2.storage-design/" rel="canonical"/>
<meta content="Nebula Graph" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../../../../assets/images/favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-4.6.3" name="generator"/>
<title>Storage Design - Nebula Graph Database Manual</title>
<link href="../../../../assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/application-palette.a8b3c06d.css" rel="stylesheet"/>
<meta content="#3f51b5" name="theme-color"/>
<script src="../../../../assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="../../../../assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="../../../../stylesheets/logo.css" rel="stylesheet"/>
<link href="../../../../css/version-select.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" dir="ltr">
<svg class="md-svg">
<defs>
<svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path></svg>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#storage_design" tabindex="0">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a aria-label="Nebula Graph Database Manual" class="md-header-nav__button md-logo" href="https://docs.nebula-graph.io" title="Nebula Graph Database Manual">
<img alt="logo" height="24" src="https://cloud-cdn.nebula-graph.com.cn/vesoft-nebula-logo-white.png" width="24"/>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              Nebula Graph Database Manual
            </span>
<span class="md-header-nav__topic">
              
                Storage Design
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/vesoft-inc/nebula" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    vesoft-inc/nebula
  </div>
</a>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://docs.nebula-graph.io" title="Nebula Graph Database Manual">
<img alt="logo" height="48" src="https://cloud-cdn.nebula-graph.com.cn/vesoft-nebula-logo-white.png" width="48"/>
</a>
    Nebula Graph Database Manual
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-source="github" href="https://github.com/vesoft-inc/nebula" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    vesoft-inc/nebula
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1" id="nav-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1">
      Overview
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-1">
        Overview
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../0.about-this-manual/" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../" title="Documentation Index">
      Documentation Index
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" id="nav-1-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-3">
      Concepts
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-3">
        Concepts
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.concepts/1.data-model/" title="Data Model">
      Data Model
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1.concepts/2.nGQL-overview/" title="nGQL Overview">
      nGQL Overview
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4" id="nav-1-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4">
      Quick Start
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-4">
        Quick Start
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.quick-start/1.get-started/" title="Get Started">
      Get Started
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.quick-start/2.FAQ/" title="FAQ">
      FAQ
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.quick-start/3.supported-clients/" title="Supported Clients">
      Supported Clients
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/1.build/1.build-source-code/" title="Build Source Code">
      Build Source Code
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/data-import/import-csv-file/" title="Import .csv File">
      Import .csv File
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1-5" id="nav-1-5" type="checkbox"/>
<label class="md-nav__link" for="nav-1-5">
      Design and Architecture
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-5">
        Design and Architecture
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../1.design-and-architecture/" title="Design and Architecture">
      Design and Architecture
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Storage Design
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="Storage Design">
      Storage Design
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#abstract">
    Abstract
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
    Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#schema_partition">
    Schema &amp; Partition
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kvstore">
    KVStore
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#raft_implementation">
    Raft Implementation
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multi_raft_group">
    Multi Raft Group
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#batch">
    Batch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learner">
    Learner
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transfer_leadership">
    Transfer Leadership
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#membership_change">
    Membership Change
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#snapshot">
    Snapshot
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#storage_service">
    Storage Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#meta_service">
    Meta Service
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../3.query-engine/" title="Query Engine">
      Query Engine
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Query Language
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-2">
        Query Language
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/0.README/" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" id="nav-2-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2-2">
      Data Types
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-2-2">
        Data Types
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/1.data-types/data-types/" title="Data Types">
      Data Types
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/1.data-types/type-conversion/" title="Type Conversion">
      Type Conversion
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" id="nav-2-3" type="checkbox"/>
<label class="md-nav__link" for="nav-2-3">
      Functions and Operators
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-2-3">
        Functions and Operators
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/bitwise-operators/" title="Bitwise Operators">
      Bitwise Operators
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/built-in-functions/" title="Built in Functions">
      Built in Functions
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/comparison-functions-and-operators/" title="Comparison Functions and Operators">
      Comparison Functions and Operators
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/group-by-function/" title="GROUP BY">
      GROUP BY
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/limit-syntax/" title="LIMIT Syntax">
      LIMIT Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/logical-operators/" title="Logical Operators">
      Logical Operators
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/operator-precedence/" title="Operator Precedence">
      Operator Precedence
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/order-by-function/" title="ORDER BY Function">
      ORDER BY Function
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/set-operations/" title="Set Operations">
      Set Operations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/string-comparison-functions-and-operators/" title="String Comparison Functions and Operators">
      String Comparison Functions and Operators
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/2.functions-and-operators/uuid/" title="UUID Function">
      UUID Function
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" id="nav-2-4" type="checkbox"/>
<label class="md-nav__link" for="nav-2-4">
      Language Structure
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-2-4">
        Language Structure
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4-1" id="nav-2-4-1" type="checkbox"/>
<label class="md-nav__link" for="nav-2-4-1">
      Literal Values
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-2-4-1">
        Literal Values
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/literal-values/boolean-literals/" title="Boolean Literals">
      Boolean Literals
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/literal-values/numeric-literals/" title="Numeric Literals">
      Numeric Literals
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/literal-values/string-literals/" title="String Literals">
      String Literals
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/comment-syntax/" title="Comment Syntax">
      Comment Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/identifier-case-sensitivity/" title="Identifer Case Sensitivity">
      Identifer Case Sensitivity
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/keywords-and-reserved-words/" title="Keywords and Reserved Words">
      Keywords and Reserved Words
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/pipe-syntax/" title="Pipe Syntax">
      Pipe Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/property-reference/" title="Property Reference">
      Property Reference
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/schema-object-names/" title="Schema Object Names">
      Schema Object Names
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/statement-composition/" title="Statement Composition">
      Statement Composition
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/3.language-structure/user-defined-variables/" title="User Defined Variables">
      User Defined Variables
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5" id="nav-2-5" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5">
      Statement Syntax
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-2-5">
        Statement Syntax
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-1" id="nav-2-5-1" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5-1">
      Data Definition Statements
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-2-5-1">
        Data Definition Statements
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/alter-edge-syntax/" title="ALTER EDGE Syntax">
      ALTER EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/alter-tag-syntax/" title="ALTER TAG Syntax">
      ALTER TAG Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/create-space-syntax/" title="CREATE SPACE Syntax">
      CREATE SPACE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/create-edge-syntax/" title="CREATE EDGE Syntax">
      CREATE EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/create-tag-syntax/" title="CREATE TAG Syntax">
      CREATE TAG Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/drop-edge-syntax/" title="DROP EDGE Syntax">
      DROP EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/drop-tag-syntax/" title="DROP TAG Syntax">
      DROP TAG Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/drop-space-syntax/" title="DROP SPACE Syntax">
      DROP SPACE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/" title="INDEX Syntax">
      INDEX Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/1.data-definition-statements/TTL/" title="TTL">
      TTL
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-2" id="nav-2-5-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5-2">
      Data Query and Manipulation Statements
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-2-5-2">
        Data Query and Manipulation Statements
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/delete-edge-syntax/" title="DELETE EDGE Syntax">
      DELETE EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/delete-vertex-syntax/" title="DELETE VERTEX Syntax">
      DELETE VERTEX Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/fetch-syntax/" title="FETCH Syntax">
      FETCH Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/go-syntax/" title="GO Syntax">
      GO Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/insert-edge-syntax/" title="INSERT EDGE Syntax">
      INSERT EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/insert-vertex-syntax/" title="INSERT VERTEX Syntax">
      INSERT VERTEX Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/lookup-syntax/" title="LOOKUP Syntax">
      LOOKUP Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/return-syntax/" title="RETURN Syntax">
      RETURN Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/update-edge-syntax/" title="UPDATE EDGE Syntax">
      UPDATE EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/update-vertex-syntax/" title="UPDATE VERTEX Syntax">
      UPDATE VERTEX Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/upsert-syntax/" title="UPSERT Syntax">
      UPSERT Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/where-syntax/" title="WHERE Syntax">
      WHERE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/2.data-query-and-manipulation-statements/yield-syntax/" title="YIELD Syntax">
      YIELD Syntax
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-3" id="nav-2-5-3" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5-3">
      Utility Statements
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-2-5-3">
        Utility Statements
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-3-1" id="nav-2-5-3-1" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5-3-1">
      SHOW Statements
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-2-5-3-1">
        SHOW Statements
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-charset-syntax/" title="SHOW CHARSET Syntax">
      SHOW CHARSET Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-collation-syntax/" title="SHOW COLLATION Syntax">
      SHOW COLLATION Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-configs-syntax/" title="SHOW CONFIGS Syntax">
      SHOW CONFIGS Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-create-space-syntax/" title="SHOW CREATE SPACE Syntax">
      SHOW CREATE SPACE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-create-tag-edge-syntax/" title="SHOW CREATE TAG EDGE Syntax">
      SHOW CREATE TAG EDGE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-hosts-syntax/" title="SHOW HOSTS Syntax">
      SHOW HOSTS Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-indexes-syntax/" title="SHOW INDEXES Syntax">
      SHOW INDEXES Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-parts-syntax/" title="SHOW PARTS Syntax">
      SHOW PARTS Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-roles-syntax/" title="SHOW ROLES Syntax">
      SHOW ROLES Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-snapshots-syntax/" title="SHOW SNAPSHOTS Syntax">
      SHOW SNAPSHOTS Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-spaces-syntax/" title="SHOW SPACES Syntax">
      SHOW SPACES Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-tags-edges-syntax/" title="SHOW TAGS EDGES Syntax">
      SHOW TAGS EDGES Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/show-statements/show-users-syntax/" title="SHOW USERS Syntax">
      SHOW USERS Syntax
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/describe-syntax/" title="DESCRIBE Syntax">
      DESCRIBE Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/3.utility-statements/use-syntax/" title="USE Syntax">
      USE Syntax
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-5-4" id="nav-2-5-4" type="checkbox"/>
<label class="md-nav__link" for="nav-2-5-4">
      Graph Algorithm
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-2-5-4">
        Graph Algorithm
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../2.query-language/4.statement-syntax/4.graph-algorithms/find-path-syntax/" title="FIND PATH Syntax">
      FIND PATH Syntax
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Build Develop and Administration
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-3">
        Build Develop and Administration
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" id="nav-3-1" type="checkbox"/>
<label class="md-nav__link" for="nav-3-1">
      Build
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-1">
        Build
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/1.build/1.build-source-code/" title="Build Source Code">
      Build Source Code
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/1.build/2.build-by-docker/" title="Build by Docker">
      Build by Docker
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" id="nav-3-2" type="checkbox"/>
<label class="md-nav__link" for="nav-3-2">
      Installation
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-2">
        Installation
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/2.install/1.install-with-rpm-deb/" title="rpm Installation">
      rpm Installation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/2.install/2.start-stop-service/" title="Start and Stop Services">
      Start and Stop Services
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/2.install/deploy-nebula-with-swarm/" title="Deploying Cluster">
      Deploying Cluster
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/2.install/3.install-with-docker/" title="Docker Installation">
      Docker Installation
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" id="nav-3-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3-3">
      Configuration
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-3">
        Configuration
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/0.system-requirement/" title="System Requirement">
      System Requirement
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/1.config-persistency-and-priority/" title="Config Persistency and Priority">
      Config Persistency and Priority
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/2.configs-syntax/" title="CONFIG Syntax">
      CONFIG Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/3.meta-config/" title="Metad Configuration">
      Metad Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/4.graph-config/" title="Graphd Configuration">
      Graphd Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/5.storage-config/" title="Storaged Configuration">
      Storaged Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/6.console-config/" title="Console Configuration">
      Console Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/7.kernel-config/" title="Kernel Configuration">
      Kernel Configuration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/3.configurations/8.single-node-log/" title="Change Log Severity on a Host">
      Change Log Severity on a Host
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" id="nav-3-4" type="checkbox"/>
<label class="md-nav__link" for="nav-3-4">
      Account Management Statement
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-4">
        Account Management Statement
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/alter-user-syntax/" title="Alter User Syntax">
      Alter User Syntax
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/authentication/" title="Authentication">
      Authentication
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/built-in-roles/" title="Built-in Roles">
      Built-in Roles
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/change-password/" title="Change Password">
      Change Password
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/create-user-syntax/" title="Create User">
      Create User
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/drop-user-syntax/" title="Drop User">
      Drop User
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/grant-role-syntax/" title="Grant Role">
      Grant Role
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/LDAP/" title="LDAP">
      LDAP
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/4.account-management-statements/revoke-syntax/" title="Revoke">
      Revoke
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" id="nav-3-5" type="checkbox"/>
<label class="md-nav__link" for="nav-3-5">
      Batch Data Management
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-5">
        Batch Data Management
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-1" id="nav-3-5-1" type="checkbox"/>
<label class="md-nav__link" for="nav-3-5-1">
      Data Import
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-3-5-1">
        Data Import
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/data-import/import-csv-file/" title="Import .csv File">
      Import .csv File
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/data-import/spark-writer/" title="Spark Writer">
      Spark Writer
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-2" id="nav-3-5-2" type="checkbox"/>
<label class="md-nav__link" for="nav-3-5-2">
      Data Export
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-3-5-2">
        Data Export
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/data-export/dump-tool/" title="Dump Tool">
      Dump Tool
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/storage-balance/" title="Storage Balance">
      Storage Balance
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/cluster-snapshot/" title="Cluster Snapshot">
      Cluster Snapshot
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/job-manager/" title="Long Time-Consuming Task Management">
      Long Time-Consuming Task Management
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/5.storage-service-administration/compact/" title="Compact">
      Compact
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" id="nav-3-6" type="checkbox"/>
<label class="md-nav__link" for="nav-3-6">
      Monitoring and Statistics
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-6">
        Monitoring and Statistics
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/7.monitor/1.metrics-exposer/" title="Metrics">
      Metrics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/7.monitor/2.meta-metrics/" title="Meta Metrics">
      Meta Metrics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/7.monitor/3.storage-metrics/" title="Storage Metrics">
      Storage Metrics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/7.monitor/4.graph-metrics/" title="Graph Metrics">
      Graph Metrics
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../3.build-develop-and-administration/7.monitor/5.rocksdb-statistics/" title="RocksDB Statistics">
      RocksDB Statistics
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" id="nav-3-7" type="checkbox"/>
<label class="md-nav__link" for="nav-3-7">
      Development and API
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-7">
        Development and API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2.quick-start/3.supported-clients/" title="Nebula Graph Clients">
      Nebula Graph Clients
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      Data Migration
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-4">
        Data Migration
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" id="nav-4-1" type="checkbox"/>
<label class="md-nav__link" for="nav-4-1">
      Nebula Exchange
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-4-1">
        Nebula Exchange
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-1" id="nav-4-1-1" type="checkbox"/>
<label class="md-nav__link" for="nav-4-1-1">
      About Nebula Exchange
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-4-1-1">
        About Nebula Exchange
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/about-exchange/ex-ug-what-is-exchange/" title="What is Nebula Exchange">
      What is Nebula Exchange
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/about-exchange/ex-ug-limitations/" title="Limitations">
      Limitations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/about-exchange/ex-ug-terms/" title="Glossary">
      Glossary
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/about-exchange/ex-ug-faq/" title="FAQ">
      FAQ
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/ex-ug-compile/" title="Compile Exchange">
      Compile Exchange
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-3" id="nav-4-1-3" type="checkbox"/>
<label class="md-nav__link" for="nav-4-1-3">
      Examples
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-4-1-3">
        Examples
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/use-exchange/ex-ug-import-steps/" title="Use Exchange">
      Use Exchange
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/use-exchange/ex-ug-import-from-csv/" title="Import data from CSV files">
      Import data from CSV files
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/use-exchange/ex-ug-import-json/" title="Import data from JSON files">
      Import data from JSON files
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/use-exchange/ex-ug-import-hive/" title="Import data from HIVE">
      Import data from HIVE
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-4" id="nav-4-1-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4-1-4">
      Parameter reference
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-4-1-4">
        Parameter reference
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/parameter-reference/ex-ug-paras-spark/" title="Spark related parameters">
      Spark related parameters
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/parameter-reference/ex-ug-paras-nebulagraph/" title="Nebula Graph related parameters">
      Nebula Graph related parameters
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-exchange/parameter-reference/ex-ug-para-import-command/" title="Import command parameters">
      Import command parameters
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/>
<label class="md-nav__link" for="nav-5">
      Nebula Graph Studio
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-5">
        Nebula Graph Studio
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" id="nav-5-1" type="checkbox"/>
<label class="md-nav__link" for="nav-5-1">
      About Nebula Graph Studio
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-1">
        About Nebula Graph Studio
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/about-studio/st-ug-what-is-graph-studio/" title="What is Studio">
      What is Studio
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/about-studio/st-ug-limitations/" title="Limitations">
      Limitations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/about-studio/st-ug-check-updates/" title="Check updates">
      Check updates
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" id="nav-5-2" type="checkbox"/>
<label class="md-nav__link" for="nav-5-2">
      Deploy and connect
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-2">
        Deploy and connect
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/install-configure/st-ug-deploy/" title="Deploy Studio">
      Deploy Studio
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/install-configure/st-ug-connect/" title="Connect to Nebula Graph">
      Connect to Nebula Graph
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" id="nav-5-3" type="checkbox"/>
<label class="md-nav__link" for="nav-5-3">
      Quick start
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-3">
        Quick start
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/quick-start/st-ug-plan-schema/" title="Design a schema">
      Design a schema
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/quick-start/st-ug-prepare-csv/" title="Prepare CSV files">
      Prepare CSV files
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/quick-start/st-ug-create-schema/" title="Create a schema">
      Create a schema
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/quick-start/st-ug-import-data/" title="Import data">
      Import data
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/quick-start/st-ug-explore/" title="Query graph data">
      Query graph data
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" id="nav-5-4" type="checkbox"/>
<label class="md-nav__link" for="nav-5-4">
      Operation guide
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-4">
        Operation guide
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4-1" id="nav-5-4-1" type="checkbox"/>
<label class="md-nav__link" for="nav-5-4-1">
      Use Schema
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-5-4-1">
        Use Schema
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/manage-schema/st-ug-crud-space/" title="Operate graph spaces">
      Operate graph spaces
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/manage-schema/st-ug-crud-tag/" title="Operate tags">
      Operate tags
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/manage-schema/st-ug-crud-edge-type/" title="Operate edge types">
      Operate edge types
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/manage-schema/st-ug-crud-index/" title="Operate indexes">
      Operate indexes
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4-2" id="nav-5-4-2" type="checkbox"/>
<label class="md-nav__link" for="nav-5-4-2">
      Use Console
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-5-4-2">
        Use Console
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/use-console/st-ug-open-in-explore/" title="Open in Explore">
      Open in Explore
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../nebula-studio/use-console/st-ug-visualize-findpath/" title="View subgraphs">
      View subgraphs
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" id="nav-6" type="checkbox"/>
<label class="md-nav__link" for="nav-6">
      Contributions
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-6">
        Contributions
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../4.contributions/contribute-to-documentation/" title="Contribute to Documentation">
      Contribute to Documentation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../4.contributions/cpp-coding-style/" title="cpp Coding Style">
      cpp Coding Style
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../4.contributions/how-to-contribute/" title="How to Contribute">
      How to Contribute
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../4.contributions/pull-request-commit-message-guidelines/" title="Pull Request and Commit Message Guidelines">
      Pull Request and Commit Message Guidelines
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" id="nav-7" type="checkbox"/>
<label class="md-nav__link" for="nav-7">
      Appendix
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-7">
        Appendix
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../5.appendix/cypher-ngql/" title="Cypher &amp; nGQL">
      Cypher &amp; nGQL
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../5.appendix/gremlin-ngql/" title="Gremlin &amp; nGQL">
      Gremlin &amp; nGQL
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../5.appendix/sql-ngql/" title="SQL &amp; nGQL">
      SQL &amp; nGQL
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../5.appendix/vid-partition/" title="Vertex Identifier and Partition">
      Vertex Identifier and Partition
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" id="nav-8" type="checkbox"/>
<label class="md-nav__link" for="nav-8">
      中文手册
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-8">
        中文手册
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://docs.nebula-graph.com.cn/" title="None">
      None
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" id="nav-9" type="checkbox"/>
<label class="md-nav__link" for="nav-9">
      PDF
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-9">
        PDF
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../pdf/document.pdf" title="Download PDF">
      Download PDF
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#abstract">
    Abstract
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#architecture">
    Architecture
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#schema_partition">
    Schema &amp; Partition
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kvstore">
    KVStore
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#raft_implementation">
    Raft Implementation
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multi_raft_group">
    Multi Raft Group
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#batch">
    Batch
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learner">
    Learner
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transfer_leadership">
    Transfer Leadership
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#membership_change">
    Membership Change
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#snapshot">
    Snapshot
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#storage_service">
    Storage Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#meta_service">
    Meta Service
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1 id="storage_design">Storage Design<a class="headerlink" href="#storage_design" title="Permanent link">¶</a></h1>
<h2 id="abstract">Abstract<a class="headerlink" href="#abstract" title="Permanent link">¶</a></h2>
<p>This document gives an introduction to the storage design of the graph database <strong>Nebula Graph</strong>.</p>
<p>The Storage Service of <strong>Nebula Graph</strong> is composed of two parts. One is <code>Meta Service</code> that stores the meta data, the other is <code>Storage Service</code> that stores the data. The two services are in two independent processes. The data directory and deployment are separated but their architectures are almost the same.</p>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">¶</a></h2>
<hr/>
<p><img alt="image" src="https://user-images.githubusercontent.com/42762957/71571213-2cd94c00-2b14-11ea-9b7f-a65067c61a63.png"/></p>
<p>Fig. 1 The Architecture of Storage Service</p>
<hr/>
<p>As shown in Fig. 1, there are three layers in Storage Service. The bottom layer is the local storage engine, providing <code>get</code>, <code>put</code>, <code>scan</code> and <code>delete</code> operations on local data. The related interfaces are in <code>KVStore/KVEngine.h</code> and users can develop their own local store plugins based on their needs. Currently, <strong>Nebula Graph</strong> provides store engine based on RocksDB.</p>
<p>Above the local storage engine is the consensus layer that implements multi group raft. Each partition corresponding to a Raft group, is for the data sharding. Currently, <strong>Nebula Graph</strong> uses <code>hash</code> to shard data. When creating a space, users need to specify the partition number. Once set, partition number cannot be changed. Generally, the partition number must meet the need to scale-out in the future.</p>
<p>Above the consensus layer is the storage interface that defines a set of APIs that are related to graph. These API requests are translated into a set of kv operations to the corresponding partition. It is this layer that makes the storage service a real graph storage, otherwise it's just a kv storage. <strong>Nebula Graph</strong> doesn't use kv-store as an independent service as a graph query involves a lot of calculation that involves schema, which is not existed in the kv layer. Such architecture makes computation operation pushing down more easily.</p>
<h2 id="schema_partition">Schema &amp; Partition<a class="headerlink" href="#schema_partition" title="Permanent link">¶</a></h2>
<p>As a graph database, <strong>Nebula Graph</strong> stores the vertices, edges and their properties. How to efficiently filtering or projecting is critical for a graph exploration.</p>
<p><strong>Nebula Graph</strong> uses <strong>tags</strong> to indicate a vertex type. One vertex can have multiple types (and therefore multiple tags), and each tag defines its own properties. In the kv store, we use <code>vertex_ID + Tag_ID</code> together as a key, and the corresponding value are the encoded property. The format is shown in Fig. 2:</p>
<hr/>
<p><img alt="image" src="https://user-images.githubusercontent.com/42762957/71571002-1252a300-2b13-11ea-915f-b3fd16920b95.png"/></p>
<p>Fig. 2 Vertex Key Format</p>
<hr/>
<ul>
<li><code>Type</code>: one byte, to indicate the key type. e.g. data, index, system, etc.</li>
<li><code>Part ID</code>: three bytes, used to indicate the (sharding) partition id. It's designed for the data migration/balance operation by <strong>prefix-scanning all the data in a partition.</strong></li>
<li><code>Vertex ID</code>: eight bytes, used to indicate vertex ID. Two vertices with an identity vertexID are considered as the same one.</li>
<li><code>Tag ID</code>: four bytes, used to indicate its tag's (encoded) ID.</li>
<li><code>Timestamp</code>: eight bytes, not visible to users. Reserved for <code>Multiversion concurrency control (MVCC)</code>.</li>
</ul>
<p>Each edge in <strong>Nebula Graph</strong> is modeled and stored as two independent key-values. One, namely the <code>out-edge</code>,  is stored in the same partition as the <code>source vertex</code>. The other one, namely <code>in-edge</code>, is stored in the same partition as the <code>destination vertex</code>. So generally, out-key and in-key are in different partitions.</p>
<p>Between two vertices, edges with the same type are acceptable, and different types are legal as well. For example, by defining an edge type '<code>money-transfer-to</code>', <code>user A</code> can transfer money to <code>user B</code> at two timestamps. Thus a field, namely <code>rank</code>, is added to (the key part of the timestamp to) distinguish which transfer records is referring.  Edge key format is shown in Fig. 3:</p>
<hr/>
<p><img alt="1" src="https://user-images.githubusercontent.com/51590253/75966340-20eb7b00-5f05-11ea-9d8e-c3ee17a33038.png"/></p>
<p>Fig. 3 Edge Key Format</p>
<hr/>
<ul>
<li><code>Type</code>: one byte, used to indicate key type. E.g., data, index, system, etc.</li>
<li><code>Part ID</code>: three bytes. The same as in Fig. 2.</li>
<li><code>Vertex ID</code>: eight bytes, used to indicate <code>source vertex ID</code> of an <code>out-edge</code>(Fig. 4), and <code>destination vertex ID</code> of an <code>in-edge</code>(Fig. 5). See below.</li>
<li><code>Edge Type</code>: four bytes, used to indicate (encoded) edge type id. A positive number means that this key is an <code>out-edge</code>, and a negative number indicates that this is an <code>in-edge</code>.</li>
<li><code>Rank</code>: eight bytes, used in multiple edges with the same type. E.g., It can store <em>transaction time</em>, <em>transaction amount</em>, or <em>edge weight</em>.</li>
<li><code>Timestamp</code>: eight bytes. The same as in Fig. 2.</li>
</ul>
<p>If <code>Edge Type</code> is positive, the corresponding edge key format is shown in Fig. 4; otherwise, the corresponding edge key format is shown in Fig. 5.</p>
<hr/>
<p><img alt="2" src="https://user-images.githubusercontent.com/51590253/75966451-5c864500-5f05-11ea-87e5-b357e29fbbd4.png"/></p>
<p>Fig. 4 Out-key format</p>
<hr/>
<p><img alt="3" src="https://user-images.githubusercontent.com/51590253/75966470-614af900-5f05-11ea-94eb-b693680f295f.png"/></p>
<p>Fig. 5 In-key format</p>
<hr/>
<p>Besides the key part above, the value part is the encoded properties (of a vertex or an edge). As a strong typed database, <strong>Nebula Graph</strong> gets the schema information from the Meta Service before encoding/decoding. And multi-version schema are also considered when altering schema.</p>
<p><strong>Nebula Graph</strong> shards data through <code>modulo operation</code> on <code>vertex ID</code>. All the <em>out-keys</em>, <em>in-keys</em> and <em>tag id</em> are placed in the same partition. This improves query efficiency as a local/non-remote file access. Breadth-First-Search (BFS) expansion starting from a given vertex is a very common ad-hoc graph exploration. And during BFS, the performance of filtering out edge/vertex properties are time-consuming. <strong>Nebula Graph</strong> guarantees the operation efficiency by putting properties of a vertex and its edges locating near each other. It is worth noting that most graph databases vendors run their benchmarks with <code>Graph 500</code> or <code>Twitter</code> data set, which are of no eloquence because the properties are not taken into consideration in this kind of graph exploration. While most production cases are not that simple.</p>
<h2 id="kvstore">KVStore<a class="headerlink" href="#kvstore" title="Permanent link">¶</a></h2>
<p><strong>Nebula Graph</strong> writes its own kv store to meet the performance needs:</p>
<ul>
<li><strong>High performance</strong>, a pure high performance key value store.</li>
<li><strong>Provided as a library</strong>, as a strong typed database, the performance of storage layer is key to <strong>Nebula Graph</strong>.</li>
<li><strong>Strong data consistency</strong>, since <strong>Nebula Graph</strong> is a distribution system.</li>
<li><strong>Written in C++</strong>, as most of our developers are C++ programers.  </li>
</ul>
<p>For users who are not sensitive to performance or unwilling to migrate data from other storage systems, such as HBase or MySQL, <strong>Nebula Graph</strong> also provides a plugin over the kv store to replace its default RocksDB. Currently, HBase plugin has been released yet.</p>
<p>As RocksDB is the local storage engine, <strong>Nebula Graph</strong> can manage multiple hard disks to take full use of the parallel IO access. What a user needs to do is to configure multiple data directories.</p>
<p><strong>Nebula Graph</strong> manages the distributed kv store in with meta service. All the partition distribution and cluster machine status can be found in the meta service. Users can input commands in the console to add or remove machines to generate and execute a balance plan in meta service.</p>
<p><strong>Nebula Graph</strong> writes its own (Write-Ahead-Log, WAL) module to replace the default one in RocksDB. Since the WAL is used for (distributed system's) Raft consensus. Each partition has a WAL, so after a (crash and) reboot, the partition can catch up its own data, and there is no need to split WAL between several partitions.</p>
<p>Besides, <strong>Nebula Graph</strong> defines a special category, namely <code>Command Operation Log</code>, to conduct some command operations. These logs are very short, with no real data, and are only used to inform all replicas to execute certain command operations with raft protocol. What's more, since the logs are serialized in the Raft protocol, <strong>Nebula Graph</strong> also provides another class, namely <code>Atomic Operation Log</code>, to conduct the atomic operation between the replicas of a partitions. E.g., the compare-and-set (CAS) or read-modify-write operations are atomic in <strong>Nebula Graph</strong> per partition.</p>
<p>A <strong>Nebula Graph</strong> cluster can have multiple individual graph spaces. Each space has its own partition number and replica copies. Different spaces are isolated physically from each other in the same cluster. Besides, the spaces can also have very different storage engines and sharding strategies. E.g., One space can use HBase as its storage backend with alphabet ranging sharding, and the other space uses the default RocksDB with hashing sharding. And these two spaces are running in the same <strong>Nebula Graph</strong> cluster.</p>
<h2 id="raft_implementation">Raft Implementation<a class="headerlink" href="#raft_implementation" title="Permanent link">¶</a></h2>
<p>This part gives some details on how the raft protocol is implemented in <strong>Nebula Graph</strong>.</p>
<h3 id="multi_raft_group">Multi Raft Group<a class="headerlink" href="#multi_raft_group" title="Permanent link">¶</a></h3>
<p>According to Raft requirement, the log ID must be in a sequential order. Therefore, almost all the raft implementations will use <code>Multi Raft Group</code> to increase the concurrency. Therefore, the number of partition will determine how many operations can be executed simultaneously. But you can not simply add too much partitions in the system, which can have some side affects. Each raft group stores many state information and (as mentioned earlier) it has a WAL file. Thus, the more partitions, the more footprint costs. Also, if the work load is low, the batch operation can not gain from the parallel. E.g., consider a system with ten thousand partitions. For every second, there are about ten thousands write-in requests. You can calculate that in average, for every partition, there is only one write-in request. So from the client side, it's a 100k batch write. But from the partition side, it's a single write.</p>
<p>There are two key challenges to implement the Multi Raft Group. <strong>First one is how to share the transport layer</strong>. Because each Raft Group  sends messages to its corresponding peers, if the transport layer cannot be shared, the connection costs will be very high. <strong>Second one is how to design the multi-threading model</strong>. Raft Groups share the same thread pool to prevent starting too many threads and a high context switch cost.</p>
<h3 id="batch">Batch<a class="headerlink" href="#batch" title="Permanent link">¶</a></h3>
<p>For each Partition, it is necessary to do batch multiple operations together to improve throughput when writing WAL serially. In general, there is nothing special about batch, but <strong>Nebula Graph</strong> designs some special types of WAL based on each part serialization, which brings some challenges.</p>
<p>For example, <strong>Nebula Graph</strong> uses WAL to implement lock-free CAS operations. And every CAS operation will be executed until the previous WAL has been committed. So for a batch, if there are some logs contain CAS operation, we need to divide this batch into several smaller (sub)groups. And make sure these (sub)groups are executed in sequential order.</p>
<h3 id="learner">Learner<a class="headerlink" href="#learner" title="Permanent link">¶</a></h3>
<p>When a new machine is added to a cluster, it has to catch up data for quite a long time. And there may be accidents during this process. If this one directly joins the raft group as a follower role, it will dramatically reduce the availability of the entire cluster. <strong>Nebula Graph</strong> introduces the learner role, and it is implemented by the command WAL mentioned above. When a leader is writing WAL and meets an <code>add learner command</code>, it will add the new coming-in learner to its peers list and mark it as a learner. The logs will send to all the peers, both the followers and the learner. But the learner can not vote for the leader's election.</p>
<h3 id="transfer_leadership">Transfer Leadership<a class="headerlink" href="#transfer_leadership" title="Permanent link">¶</a></h3>
<p>Transfer leadership is extremely important during a data balance operation. When migrating a partition from one machine to another, <strong>Nebula Graph</strong> will first check if it is a leader. If so, another follower should be elected as a leader before the migration. Otherwise, the cluster service is affected since the leader is on migration. After the migration is done, a <code>BALANCE LEADER</code> command is invoked, so that the work load on each machine can be balanced.</p>
<p>When transferring leadership, it is worth noting the timing when a leader abandons the leadership and when all the followers start a leader election. When a <code>transfer leadership</code> command is committed, from the leader's view, it loses the leadership. From other followers' view, when receiving this command, it starts a new leader election. These two operations must be executed in the same process with a normal raft leader election. Otherwise, some corner cases can occur and they are very hard to test.</p>
<h3 id="membership_change">Membership Change<a class="headerlink" href="#membership_change" title="Permanent link">¶</a></h3>
<p>To avoid the brain-split, when Raft Group members changed, an intermediate state is required. In such state, the majority of the old group and new group always have an overlap. This majority overlap will prevent neither group from making decisions unilaterally. This is the <code>joint consensus</code> as mentioned in the famous Raft thesis. To make it even simpler, Diego Ongaro suggests to <strong>add or remove only one peer at a time to ensure the overlap between the majority</strong> in his doctoral thesis. <strong>Nebula Graph</strong>'s implementation also uses this approach, except that the implementation to add or remove member is different. For details, please refer to <code>addPeer/removePeer</code> in Raft Part source code.</p>
<h3 id="snapshot">Snapshot<a class="headerlink" href="#snapshot" title="Permanent link">¶</a></h3>
<p>Take snapshot is a common command during daily DBA operations. But snapshot operation will introduce extra challenges when considering together with the raft protocol. It's very error-prone.</p>
<p>E.g., what if the leader loses its leadership in an election when sending a snapshot command. What should we do. In this situation, the follower may only receive half log of the snapshot command, should we cleanup and rollback? Because multiple partitions share a single storage, how to clean up the data is a cumbersome work. In addition, the snapshot process will start a heavy write to disks. To avoid slow down the frontend reads and writes, we do not want snapshot process to share the same IO threadPool with the normal Raft logs. Besides, snapshot also requires large footprint, which is critical for online service performance.</p>
<h2 id="storage_service">Storage Service<a class="headerlink" href="#storage_service" title="Permanent link">¶</a></h2>
<p>The Interfaces of Storage Service layer are:</p>
<ul>
<li><code>Insert vertex/edge</code>: insert a vertex or edge and its properties.</li>
<li><code>getNeighbors</code>: get the in-edge or out-edge from a set of vertices. And return the edges and properties. Condition filtering are also considered.</li>
<li><code>getProps</code>: get the properties of a vertex or an edge.</li>
</ul>
<p>Graph semantics interfaces are translated into kv operations in this layer as well. In order to improve the performance, concurrent operations are also implemented in this layer.</p>
<h2 id="meta_service">Meta Service<a class="headerlink" href="#meta_service" title="Permanent link">¶</a></h2>
<p><strong>Nebula Graph</strong> wrap up a set of meta-related interfaces from the kv store interface (as mentioned earlier). Meta service can support CRUD operation on schema, cluster administration and user privileges. Meta service can be deployed on a single host, but it is recommended to deploy on multiple hosts with at least three or five replicas to get a better availability and fault tolerance.</p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../1.design-and-architecture/" rel="prev" title="Design and Architecture">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Design and Architecture
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../3.query-engine/" rel="next" title="Query Engine">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Query Engine
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 Nebula Graph
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" rel="noopener" target="_blank">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs</a>
 ... <a class="link--pdf-download" download href="../../../../pdf/document.pdf" title="PDF">download PDF</a></div>
<div class="md-footer-social">
<link href="../../../../assets/fonts/font-awesome.css" rel="stylesheet"/>
<a class="md-footer-social__link fa fa-github" href="https://github.com/vesoft-inc/nebula" rel="noopener" target="_blank" title="github"></a>
<a class="md-footer-social__link fa fa-weibo" href="https://www.weibo.com/u/7122684542?is_hot=1" rel="noopener" target="_blank" title="weibo"></a>
<a class="md-footer-social__link fa fa-twitter" href="https://twitter.com/NebulaGraph" rel="noopener" target="_blank" title="twitter"></a>
<a class="md-footer-social__link fa fa-linkedin" href="https://www.linkedin.com/company/vesoft-nebula-graph/" rel="noopener" target="_blank" title="linkedin"></a>
<a class="md-footer-social__link fa fa-facebook" href="https://www.facebook.com/NebulaGraph/" rel="noopener" target="_blank" title="facebook"></a>
<a class="md-footer-social__link fa fa-slack" href="https://app.slack.com/client/TJB3N2BPD/CJNFUM7AR" rel="noopener" target="_blank" title="slack"></a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../../../assets/javascripts/application.c33a9706.js"></script>
<script>app.initialize({version:"1.1.2",url:{base:"../../../.."}})</script>
<script src="../../../../js/version-select.js"></script>
</body>
</html>