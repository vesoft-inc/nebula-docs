# 创建服务实例

在使用{{cloud.name}}（阿里云版）前，要先在阿里云控制台创建服务实例。

## 账号与权限

- 准备[阿里云账号](http://c.nxw.so/bC0B2 "https://help.aliyun.com/document_detail/324606.html")。
- 如果使用 RAM 用户创建实例，需为其添加以下权限：

  - AliyunECSFullAccess
  - AliyunVPCFullAccess
  - AliyunROSFullAccess
  - AliyunCloudMonitorFullAccess
  - AliyunComputeNestUserFullAccess

## 资源与费用

{{cloud.name}}（阿里云版）支持免费试用和付费使用，二者的详细说明如下表。

| 项目 | 免费试用版 | 付费版 |
| - | - | - |
| 云资源归属 | 阿里云官方账号 | 用户账号 |
| 云资源费用 | **阿里云承担** | 用户承担 |
| 云资源使用时长 | 30 天（不可续期） | 用户创建实例时选择 |
|  {{nebula.name}} 许可证费用 | **试用期内免费** | 用户承担 |
|  {{nebula.name}} 服务许可证有效期 | 30 天 | 用户创建实例时选择 |
| 许可证过期后数据是否保留 | 否（因云资源会同时到期） | 是 |
| 云资源到期后数据是否保留 | 否 | 否 |
| 数据盘快照费用 | **阿里云承担** | 用户承担（可关闭功能） |

## 数据备份

在创建服务实例时，系统会默认开启数据盘自动快照备份，用于周期性备份 {{nebula.name}} 数据。

创建付费版服务实例前需[开通快照](https://help.aliyun.com/document_detail/108381.html)。免费试用实例使用的是阿里云官方账号下的资源，已开通快照，无需用户手动开通。

默认的快照备份策略为每天 00:00 创建快照。

创建快照会产生费用，详情参见[快照计费](https://help.aliyun.com/document_detail/56159.htm)。

如需删除快照、修改或删除自动快照策略，参见[快照文档](https://help.aliyun.com/document_detail/108376.html)。

## 套餐版本

{{cloud.name}}（阿里云版）支持如下套餐版本。

| 套餐版本 | 说明 |
| - | - |
| 基础版 | 将所有 {{nebula.name}} 服务节点部署在 1 台 ECS 服务器上。 |
| 标准版 | 将 Graph 服务和 Storage 服务分别部署在不同的 ECS 服务器上，每个服务都是单节点（1 台 ECS）。将生态工具混合部署在 1 台 ECS 服务器上。 |
| 高可用版 |  将 Graph 服务和 Storage 服务分别部署在不同的 ECS 服务器上，每个服务都包含 3 节点（3 台 ECS）。将生态工具混合部署在 1 台 ECS 服务器上。 |

付费版和免费试用版服务实例支持的套餐版本有所不同，详情参见创建实例页面。

## 创建付费版服务实例

1. 登录[阿里云控制台](https://home.console.aliyun.com/home/dashboard/ProductAndService)。

2. 打开云市场的 [{{nebula.name}} 产品页](https://market.aliyun.com/products/56024006/cmgj00059955.html?#sku=yuncode5395500004)。

3. 选择**套餐版本**和**购买时长**（即 {{nebula.name}} 服务的许可证有效期），并单击**立即购买**。

4. 在**创建服务实例**页，保持**选择模板**处的选择不变。如需切换部署架构，可改变选中的选项，重新选择模板。

  !!! note

        改变模板会改变之前选择的套餐版本，软件费用（ {{nebula.name}} 许可证费用）和创建服务实例需要的资源也会改变。

5. （可选）设置**服务实例名称**。默认值为服务实例 ID。

6. 选择要创建服务实例的**地域**。

7. 在**付费模式设置**区域，指定 ECS 服务器的付费方式。默认为**按量付费**。

  - **按量付费**：按照计费周期计费，在每个结算周期生成账单并从账户中扣除相应费用。详情参见[按量付费](https://help.aliyun.com/document_detail/40653.html)。

  - **包年包月**：先付费后使用。详情参见[包年包月](https://help.aliyun.com/document_detail/56220.html)。选择包年包月模式需要指定**购买时长周期**和**购买时长**。**购买时长周期**当前仅支持 **Month**，即按月购买。

8. 在 ** {{nebula.name}} 配置**区域，完成数据盘和 ECS 服务器密码设置。
  
9. 在**基础设施配置**区域，完成以下设置。

  1. 选择**专有网络 VPC 实例 ID**。

    如果下拉列表为空，先单击其右侧的**新建专有网络**，完成专有网络创建。

  2. 选择**交换机可用区**。

  3. 选择**业务网络交换机的实例 ID**。

    如果下拉列表为空，先单击其右侧的**新建交换机**，完成交换机创建。

10. 完成**权限确认**，并选中**我同意授权服务商（杭州悦数科技有限公司）获取上述权限以提供代运维服务**。

11. 在页面底部，单击**下一步：确认订单**。

12. 在**服务条款**区域，勾选**我已阅读并同意《商品在线协议》《云市场平台服务协议》《计算巢服务协议》**。

13. 在页面底部，单击**立即支付**。

14. 在**支付**页面，选择支付方式，之后单击页面底部的**支付**。

15. 在**支付完成**页面，单击**管理控制台**。

16. 在**已购买的服务**页面，单击要创建的实例右侧的**立即进入计算巢部署或查看部署详情**。

  !!! note

        如果已购买的服务列表中未显示要创建的实例，刷新页面。

17. 在**服务实例详情**页查看实例的**状态**，确保状态为**部署中**。

  部署的平均耗时为 10 分钟。完成后实例的状态变为**已部署**。

## 创建免费版试用版服务实例

!!! danger
    免费试用实例不可在生产环境中使用。

1. 登录阿里云计算巢[推荐服务](http://c.nxw.so/bC0C0 "https://computenest.console.aliyun.com/user/cn-hangzhou/recommendService")页面，搜索 ** {{nebula.name}} **。

2. 在 ** {{nebula.name}} 集群版**卡片上，单击**免费试用**。

3. 系统会为首次创建 {{nebula.name}} 服务实例的用户弹出申请对话框。在**申请权限**对话框中填写申请人信息。带有红色星号（*）的为必填项。

  !!! note
  
        申请通过后需从第 1 步重新开始。

4. （可选）设置**服务实例名称**。默认值为服务实例 ID。

5. 选择要创建实例的**地域**。

6. 在 ** {{nebula.name}} 配置**区域，完成数据盘和 ECS 服务器密码设置。
  
7. 在**基础设施配置**区域，选择**交换机可用区**。

8. 完成**权限确认**，并选中**我同意授权服务商（杭州悦数科技有限公司）获取上述权限以提供代运维服务**。

9. 在页面底部，单击**下一步：确认订单**。

10. 在**服务条款**区域，勾选**我已阅读并同意《计算巢服务协议》**。

11. 在页面底部，单击**开始免费试用**。

12. 在**提交成功**页面，单击**去列表查看**。

13. 在实例列表中查看目标实例的**状态**，确保状态为**部署中**。

  部署的平均耗时为 10 分钟。完成后实例的状态变为**已部署**。

## 常见问题

Q：服务实例的状态显示为**部署失败**怎么处理？

1. 如果使用 RAM 账号创建的实例，确认为该账号授予了本文前提条件中指定的权限。
2. 如果权限符合要求，[删除](https://help.aliyun.com/document_detail/290837.html)创建失败的实例，尝试重新创建。
3. 如果仍然创建失败，到 [{{nebula.name}} 论坛](https://discuss.nebula-graph.com.cn/)寻求帮助。
